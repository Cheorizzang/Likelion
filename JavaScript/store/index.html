<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>위니브 스토어</title>
        <link
            href="//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css"
            rel="stylesheet"
            type="text/css"
        />
        <link rel="stylesheet" href="src/style/style.css" />
    </head>

    <body>
        <div id="root">
            
        </div>
        <script>
            const root = document.getElementById('root')

            // 통일성을 해친 것
            // async awiat을 썼으면 아래 코드도 then이 아니라 똑같은거 쓰는게 좋음
            async function getProductData(){
                const response = await fetch("http://test.api.weniv.co.kr/mall")
                // fetch는 promise를 반환. 얘를 기다려야 response값이 제대로 반환됨? 그래서 await 써줘야함
                const product = response.json()
                return product
            } 
            // async가 앞에 있으면 그 함수는 promise라서 getProductData는 promise임
            getProductData()
            .then((product) => {
                // console.log(product);
                const mainElement = document.createElement('main')
                mainElement.classList.add('product')
                // console.log(mainElement);

                // 통일성을 해친 것
                // innerHTML / DOM 둘중에 하나로 끝까지 하는게 좋음
                mainElement.innerHTML = `
                    <h1 class="ir">상품목록</h1>
                    <ul class="product-list"></ul>
                `;
                // console.log(mainElement);

                const productList = mainElement.querySelector('.product-list');
                product.forEach(item => {
                    // console.log(item);
                    const productDetailLink = document.createElement('a')
                    productDetailLink.href = `/detail/${item.id}`
                    // console.log(productDetailLink);
                    productDetailLink.innerHTML = `
                        <li>
                            <div>${item.thumbnailImg}</div>
                            <div>${item.productName}</div>
                            <div>${item.price}</div>
                        </li>
                        `;
                    // console.log(productDetailLink);
                    productList.append(productDetailLink);
                    });
                    console.log(mainElement);
                    const cart = document.createElement("a");
                    cart.setAttribute("class", "link-btn cart-link");
                    mainElement.append(cart);

                    // console.log(productList)
                    // console.log(mainElement)
                    root.append(mainElement);
            })
            .then()
            .catch();
        </script>
    </body>
</html>
